function [a,b,gammaval,L] = MobiusFactor(a1,a2,b1,b2)

a1 = vpa(a1,64);
a2 = vpa(a2,64);
b1 = vpa(b1,64);
b2 = vpa(b2,64);

a = vpa((a1+a2+(-2).*((a1+a2+(-1).*b1+(-1).*b2).^( ...
-1).*(a1.*a2+(-1).*b1.*b2)+((a1+a2+(-1).*b1+(-1).*b2).^(-2).*( ...
a1.^2.*a2.^2+(-1).*a1.^2.*a2.*b1+(-1).*a1.*a2.^2.*b1+a1.*a2.* ...
b1.^2+(-1).*a1.^2.*a2.*b2+(-1).*a1.*a2.^2.*b2+a1.^2.*b1.*b2+2.* ...
a1.*a2.*b1.*b2+a2.^2.*b1.*b2+(-1).*a1.*b1.^2.*b2+(-1).*a2.*b1.^2.* ...
  b2+a1.*a2.*b2.^2+(-1).*a1.*b1.*b2.^2+(-1).*a2.*b1.*b2.^2+b1.^2.* ...
  b2.^2)).^(1/2))).^(-1).*(2.*a1.*a2+(-1).*a1.*((a1+a2+(-1).*b1+(-1) ...
  .*b2).^(-1).*(a1.*a2+(-1).*b1.*b2)+((a1+a2+(-1).*b1+(-1).*b2).^( ...
  -2).*(a1.^2.*a2.^2+(-1).*a1.^2.*a2.*b1+(-1).*a1.*a2.^2.*b1+a1.* ...
  a2.*b1.^2+(-1).*a1.^2.*a2.*b2+(-1).*a1.*a2.^2.*b2+a1.^2.*b1.*b2+ ...
  2.*a1.*a2.*b1.*b2+a2.^2.*b1.*b2+(-1).*a1.*b1.^2.*b2+(-1).*a2.* ...
 b1.^2.*b2+a1.*a2.*b2.^2+(-1).*a1.*b1.*b2.^2+(-1).*a2.*b1.*b2.^2+ ...
  b1.^2.*b2.^2)).^(1/2))+(-1).*a2.*((a1+a2+(-1).*b1+(-1).*b2).^(-1) ...
  .*(a1.*a2+(-1).*b1.*b2)+((a1+a2+(-1).*b1+(-1).*b2).^(-2).*(a1.^2.* ...
  a2.^2+(-1).*a1.^2.*a2.*b1+(-1).*a1.*a2.^2.*b1+a1.*a2.*b1.^2+(-1).* ...
  a1.^2.*a2.*b2+(-1).*a1.*a2.^2.*b2+a1.^2.*b1.*b2+2.*a1.*a2.*b1.*b2+ ...
  a2.^2.*b1.*b2+(-1).*a1.*b1.^2.*b2+(-1).*a2.*b1.^2.*b2+a1.*a2.* ...
 b2.^2+(-1).*a1.*b1.*b2.^2+(-1).*a2.*b1.*b2.^2+b1.^2.*b2.^2)).^( ...
 1/2))),64);

b = vpa((a1+a2+(-1).*b1+(-1).*b2).^(-1).*(a1.*a2+( ...
-1).*b1.*b2)+((a1+a2+(-1).*b1+(-1).*b2).^(-2).*(a1.^2.*a2.^2+(-1) ...
  .*a1.^2.*a2.*b1+(-1).*a1.*a2.^2.*b1+a1.*a2.*b1.^2+(-1).*a1.^2.* ...
  a2.*b2+(-1).*a1.*a2.^2.*b2+a1.^2.*b1.*b2+2.*a1.*a2.*b1.*b2+a2.^2.* ...
  b1.*b2+(-1).*a1.*b1.^2.*b2+(-1).*a2.*b1.^2.*b2+a1.*a2.*b2.^2+(-1) ...
  .*a1.*b1.*b2.^2+(-1).*a2.*b1.*b2.^2+b1.^2.*b2.^2)).^(1/2),64);

gammaval = vpa((a1+a2-2*a)./(a2-a1),64);

L = vpa(1/((2*a-(b1+b2))/(b2-b1)/gammaval),64);

if a1 < a && a < a2 && b1 < b && b < b2 && L > 0
    a = double(a);
    b = double(b);
    gammaval = double(gammaval);
    L = double(L);
    return;
else
    error('Mobius Transform error');
end

end